just reading through this code made me wonder what the heck we were ever thinking