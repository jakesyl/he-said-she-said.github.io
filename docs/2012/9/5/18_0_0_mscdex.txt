you could write a middleware function that checks both places