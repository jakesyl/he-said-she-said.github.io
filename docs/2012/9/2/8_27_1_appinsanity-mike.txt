btw: when you == buffer[i] better check the high bits before you because it might be unicode