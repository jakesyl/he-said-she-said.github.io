rovar, https://gist.github.com/3602657 this is with a small hash table, do you see what I meant about rarely having to include the whole data set