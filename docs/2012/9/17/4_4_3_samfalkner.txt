Here is the result: http://pastebin.com/7Gfh7s9K