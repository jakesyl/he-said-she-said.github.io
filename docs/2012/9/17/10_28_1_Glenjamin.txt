a custom implementation should look similar to that middleware