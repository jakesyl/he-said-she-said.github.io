alright so ignoring the strange reproducibility characteristics of the bug, the issue seems to be that after redirecting to the actual app ("/app") from the login page ("/"), the authenticated session data doesn't seem to save. So when the "/app" handler checks if the authentication token exists in the session data, it sees that it doesn't, and kicks the user out.