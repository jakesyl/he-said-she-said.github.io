well this may eventually turn in to a pure javascript implementation