spion_: I have rewritten and split this up a lot, I guess it's not very transparent anymore