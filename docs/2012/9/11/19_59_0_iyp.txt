Dieterbe: I know mongodb has an $inc update that operates atomically 