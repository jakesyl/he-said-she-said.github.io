starlog: look at github.com/joyent/node/tree/src/udp_wrap.{cc,h}