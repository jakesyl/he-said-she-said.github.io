streams are what you want to use for stuff like this.