copy of the sorting function(s), no data though http://pastebin.com/nRzwrHMk