garthk: performance might be a concern here