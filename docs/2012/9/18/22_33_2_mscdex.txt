if i move the logic into the 'data' event, i get throughputs of ~0.3 gbit/sec