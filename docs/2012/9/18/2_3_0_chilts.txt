I wonder if $client->begin() or $client->commit() or $client->rollback() can do both the SQL _and_ the drain stuff for you?