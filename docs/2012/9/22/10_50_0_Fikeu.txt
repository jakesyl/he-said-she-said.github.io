I have a bit of code that looks something like this (don't think it's worth it to pastie it):