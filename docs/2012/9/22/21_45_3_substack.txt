reading through the lib/zlib.js source