ksmth, maybe it's time for rewrite? :)