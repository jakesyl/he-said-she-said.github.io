I've writter mux-demux like stuff before on top of tcp and udp