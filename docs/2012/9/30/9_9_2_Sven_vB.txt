and about the callbacks, you can cheat around them a bit so that your code still looks sequential even if it isn't