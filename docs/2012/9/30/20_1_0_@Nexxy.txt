perhaps you should use recursion instead of a while loop