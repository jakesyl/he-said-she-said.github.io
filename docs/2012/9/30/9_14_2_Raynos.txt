As for clean code, just use streams ( https://gist.github.com/eaa2c76088902d42fb1d )