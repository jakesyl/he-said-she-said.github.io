from the node.js sources