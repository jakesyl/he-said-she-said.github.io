i'd guess that is it, because that loop will keep on reading much faster than the upserts are happening