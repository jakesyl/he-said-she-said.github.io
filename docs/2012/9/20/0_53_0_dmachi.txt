it is kind of wierd, but mine more or less does the same thing though I used a buffer and did an event based setup to trigger the upsert on each record)