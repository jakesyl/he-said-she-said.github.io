how would middleware solve the problem?