isaacs had a nice tutorial on writing a flow control module