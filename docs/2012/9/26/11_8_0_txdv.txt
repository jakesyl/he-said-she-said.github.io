rendar: writing all the encoding code in js is insane and slow