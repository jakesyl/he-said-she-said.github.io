you can get a look at the code and the problem at http://pastebin.com/pMeahr6P