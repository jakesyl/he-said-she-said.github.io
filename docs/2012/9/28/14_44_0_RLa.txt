i think the usual solution is do it through concurrency queue and set concurrency limit on the queue