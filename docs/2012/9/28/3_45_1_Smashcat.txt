(there's also websocket code etc, but that's not being used in the tests)