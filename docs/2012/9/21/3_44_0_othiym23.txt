but the callback attached to it doesn't fire until it's done, and when I dump its state, I can see that the response is finished by the time the end code runs