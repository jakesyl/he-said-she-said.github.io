it's a very naive implementation, but I can't figure out what's wrong