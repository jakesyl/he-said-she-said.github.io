thl0, Spion, thanks - I thought I could do it without putting my procedure inside the function...