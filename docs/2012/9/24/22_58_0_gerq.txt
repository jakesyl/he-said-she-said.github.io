I suspect fs.writeFile decides to not close immediately, and for some reason the child inherits the file descriptors, and they are only closed in the parent.