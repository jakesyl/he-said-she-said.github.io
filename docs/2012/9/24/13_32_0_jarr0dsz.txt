this is going to be exterme complicated ;p