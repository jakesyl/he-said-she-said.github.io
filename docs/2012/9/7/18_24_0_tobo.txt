all 400 SLOC of overkill