So I've got a version that passes most of the tests doing MapReduce in Ruby