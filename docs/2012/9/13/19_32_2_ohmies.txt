it even calls `end` at the end of stream automatically