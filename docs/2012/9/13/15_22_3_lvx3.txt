some crazy unweildy abuse of a dependency injection framework