my life would be a lot simpler right now if zlib.deflate were synchronous