i think i should port this to C#