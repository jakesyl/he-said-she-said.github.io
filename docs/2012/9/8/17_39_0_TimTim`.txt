that's gonna be a lot of ugly code, i think