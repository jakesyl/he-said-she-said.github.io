threads are such a clusterfuck