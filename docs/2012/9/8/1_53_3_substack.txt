if it is costly you could use mux-demux for that