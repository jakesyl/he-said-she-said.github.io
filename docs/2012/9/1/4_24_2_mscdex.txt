jergason: pull them out into separate, logical functions?