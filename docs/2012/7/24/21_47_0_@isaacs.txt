tjholowaychuk: the next optimization level would be to have it abort every non-dir, so that it doesn't read the files.