writing async code without callbacks.