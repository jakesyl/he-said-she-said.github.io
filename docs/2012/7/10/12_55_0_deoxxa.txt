you're calling close() before it's done