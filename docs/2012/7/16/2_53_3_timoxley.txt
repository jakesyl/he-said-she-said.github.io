cgiffard look at the code again