samholmes, a few too many anon functions for my liking; that's about the only criticism I can think of off the top of my head