exec a function, and then wait for it to finish