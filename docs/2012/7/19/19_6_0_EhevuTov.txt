except instead of recreating the wheel, I'd use ASN.1 and do the standard packing like BER and then use the latest and greatest for another