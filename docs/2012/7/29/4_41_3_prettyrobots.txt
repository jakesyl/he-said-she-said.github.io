Also, I'm using function names to do branching, which is a bunch of fun.