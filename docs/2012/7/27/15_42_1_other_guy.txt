rather than rewrite a chunk of our app stack in C