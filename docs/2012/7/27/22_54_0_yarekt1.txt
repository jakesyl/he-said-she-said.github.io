I used to push them all in a queue before, and then loop through it and process. but that turned out to be messy, and not memory efficient, i had to keep the whole data in memory at the end