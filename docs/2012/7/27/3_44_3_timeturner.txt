not having closures in C is a disappointment ^ :/