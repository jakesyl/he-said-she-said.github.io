Pasted 3435 bytes to http://codepad.org/PJr8UR4x