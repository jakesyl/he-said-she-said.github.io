But there is another race condition even when using this. If the server is abit slow, and sends the second batch after the client has finished processing, it would think that its done