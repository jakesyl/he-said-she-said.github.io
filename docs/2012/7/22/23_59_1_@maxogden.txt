have you seen https://github.com/dominictarr/mux-demux ?