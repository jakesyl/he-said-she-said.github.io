i wrote a ruby port of it, was slow