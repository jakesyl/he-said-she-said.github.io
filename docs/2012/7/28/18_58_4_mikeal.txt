connect middleware using a continuation passing API