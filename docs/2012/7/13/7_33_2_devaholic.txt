dominictarr: the reply parser could be optimized a bit, but it works