Actuallly, what about PostgreSQL? Have a transactional database do your atomicity.