then I re-implemented the parser step by step