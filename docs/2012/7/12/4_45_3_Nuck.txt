brianc: line breaks in the data should be escaped I think