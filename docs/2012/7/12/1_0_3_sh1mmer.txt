https://github.com/tjanczuk/tripwire/blob/master/src/tripwire.cc