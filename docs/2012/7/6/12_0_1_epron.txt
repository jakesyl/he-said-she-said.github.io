my code is here: https://github.com/attheodo/katina_node/blob/master/katina.js