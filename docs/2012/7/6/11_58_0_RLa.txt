use a queue or process next page after previous one is finished