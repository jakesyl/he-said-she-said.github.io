typeof is a lame way to determine type, instead use the objecy's contructor property.