use something like dnode to split it between the part that just listens to conversations and handles the timeouts, and a part that you want to iterate on