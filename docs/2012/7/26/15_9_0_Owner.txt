javascript scoping has stumped me