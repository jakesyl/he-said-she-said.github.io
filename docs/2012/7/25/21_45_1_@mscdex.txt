other_guy: i did something similar for node-imap and just used a closure