I wrote https://gist.github.com/3119292 the other day