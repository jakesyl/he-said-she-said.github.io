while (!waiting) {...} if (!waiting) {...} seems a little redundent