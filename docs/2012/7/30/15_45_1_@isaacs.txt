dominictarr: i'm a bit worried that supporting multi-pipe automatically will degrade perf, but i'll have to check on that