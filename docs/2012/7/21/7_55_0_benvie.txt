it's 500 linues of code that looks way simpler than it is =D