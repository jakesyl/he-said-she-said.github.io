why is there so much ifdefing for OS's in node, instead of feature tests?