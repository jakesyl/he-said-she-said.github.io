honestly that code is awful to read