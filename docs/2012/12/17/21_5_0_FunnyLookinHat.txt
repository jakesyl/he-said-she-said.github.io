KeOps, looks good to me, I'd throw a console.log() around all of your expected socket events to make sure you're parsing the data correctly.