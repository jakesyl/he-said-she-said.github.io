owen1: do you need anything other than the message id's then? i'd save all incoming ids into a list, then put failed into one list and succeeded into another