Co-operative "threading" built on continuations