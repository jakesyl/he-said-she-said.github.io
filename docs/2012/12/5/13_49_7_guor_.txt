in any case, why don't you just create a result buffer, write into that, and don't use any strings