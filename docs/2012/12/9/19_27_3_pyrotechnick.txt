This function is asynchronous. The last parameter callback will be added as a listener for the 'listening' event. 