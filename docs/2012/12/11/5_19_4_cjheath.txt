I'm converting this to work as a node module: https://github.com/cjheath/semper