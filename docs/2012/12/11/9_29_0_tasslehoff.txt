Gottox: does this seem correct: http://pastebin.com/cZjbfcqe ? 