but I think I'm doing something wrong with the memory management