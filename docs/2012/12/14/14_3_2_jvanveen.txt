not sure if this is the best way to handle pooling, but i cant think of a better way