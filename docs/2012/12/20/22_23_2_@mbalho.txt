also: your socket.io emit needs to happen after youve stored the on('connection') socket object