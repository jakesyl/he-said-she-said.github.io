the reference wrapping is insane if you want to do it right