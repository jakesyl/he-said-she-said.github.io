it uses AST of course