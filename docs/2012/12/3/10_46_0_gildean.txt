Rotevit: also, try to divide the code into smaller modules, that are easier to handle and to read