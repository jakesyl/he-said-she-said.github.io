it seems kinda wonky to pass in TWO callbacks (one for on.row and the other for on.end)