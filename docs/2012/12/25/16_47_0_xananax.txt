the code is at http://pastie.org/5576471, the lines concerning npm auto-complete at #52, if anyone cares to take a look