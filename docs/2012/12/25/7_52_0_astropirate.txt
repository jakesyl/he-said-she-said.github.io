niggler, how was the math engine implemented