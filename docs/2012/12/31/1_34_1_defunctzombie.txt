the amount of globals introduced should be minimal if possible