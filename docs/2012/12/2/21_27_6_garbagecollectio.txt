smith_: without using cluster