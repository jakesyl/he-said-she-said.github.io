There, I just do it all in memory, no streams or anything - obviously your method would need to be a bit more intelligent there