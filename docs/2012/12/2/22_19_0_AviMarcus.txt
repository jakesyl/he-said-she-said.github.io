I still don't quite understand how next gets defined and used. If it's parallel.next then how is it called within the functions?