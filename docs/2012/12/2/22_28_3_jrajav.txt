You could also skip using next() at all, at the price of more obscure continuation passing in the parallel functions