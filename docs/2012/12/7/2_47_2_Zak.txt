i've found a number of bugs but i've just stumbled across the main chunk of code which runs the test on the browser locally and i'm a little stumped