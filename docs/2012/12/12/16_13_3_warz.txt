honestly, it sounds like you're clumping together too much logic. split that stuff out.