if you can't do that, then just go all out map reduce.