buffer.copy uses memmove, not memcpy