most of the action is in NodeListener.cc