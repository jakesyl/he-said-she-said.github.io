I *think* it's an async timing or context issue, but I don't really see from the code where the issue is