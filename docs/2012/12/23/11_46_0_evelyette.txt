the socket.io code is as follows: http://dpaste.com/850504/