terietor: to start off with, anywhere you're using function ()... split it out into a named function