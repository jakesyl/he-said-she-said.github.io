that code is a complete shambles