i feel dirty using a semaphore