which algorithm and where's the problem?