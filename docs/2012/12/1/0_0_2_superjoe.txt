it will emit an 'end' event when done