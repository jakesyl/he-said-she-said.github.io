my code works for non authenticated requests but not for the authenticated ones