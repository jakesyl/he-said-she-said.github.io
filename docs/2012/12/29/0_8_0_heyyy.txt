i'm writing a node module, but it could also work in the browser... i'm having trouble understanding how to structure it without having 2 files for each case