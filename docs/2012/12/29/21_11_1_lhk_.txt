posted this on SO, too: