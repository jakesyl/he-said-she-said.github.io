I must say the streaming interface of crypto makes your code a bit more verbose. https://gist.github.com/4409445 vs https://gist.github.com/4409449