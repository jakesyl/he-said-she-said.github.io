isaacs i guess its time for me to write a state-machine generator for this...