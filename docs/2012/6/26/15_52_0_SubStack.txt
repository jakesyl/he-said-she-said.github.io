it's really terse but it took forever to figure out how best to fit it into dnode/dnode-protocol