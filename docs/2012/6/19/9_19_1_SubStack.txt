it seems like the only place to put the feature detection is into .pipe() itself