i think the stream stuff can be cleaned up a little but i'm no expert at that