this is a biger chunk of the code