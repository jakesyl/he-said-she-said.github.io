personally, I would have a long-running dedicated background process that accepts data from your main process