ugly, but i was just porting it