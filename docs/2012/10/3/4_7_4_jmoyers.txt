current stream api is messy imo