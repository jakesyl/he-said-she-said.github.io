switching to a read loop is a nice compromise