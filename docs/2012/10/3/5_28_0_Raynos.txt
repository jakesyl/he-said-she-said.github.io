but it's easy to write when you do it in two parts, cached operation & cached emitter