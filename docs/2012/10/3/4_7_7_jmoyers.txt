just look at pipe implementation