seriously the function in the native HTTP parser we had to dig through was 1266 lines long