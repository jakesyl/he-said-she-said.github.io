with a little map reduce on the side