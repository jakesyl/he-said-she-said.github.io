niggler: i think an issue is that your decode_col with the for loop returns a different number than the first decode_col?