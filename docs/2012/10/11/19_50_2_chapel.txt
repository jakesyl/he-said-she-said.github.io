sync in node halts the whole process