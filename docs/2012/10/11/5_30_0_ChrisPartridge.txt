all those } else's are making me dizzy