Nuck, I suppose it wasn't too hard once I resolved to write a bunch of helpers