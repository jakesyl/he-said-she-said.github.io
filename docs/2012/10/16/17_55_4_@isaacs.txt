you'll have to have the long-running function check for messages