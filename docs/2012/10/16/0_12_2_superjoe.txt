it's amazing how much you can abstract once you assume async