this looks like it's going to be a little more complex than lua overall