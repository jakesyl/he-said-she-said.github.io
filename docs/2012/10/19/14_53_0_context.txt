you have server.listen() INSIDE the connection listener which will never get called if you are not listening