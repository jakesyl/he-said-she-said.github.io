Solved this by keeping a counting semaphore that is incremented/decremented upon the start/completion of each insert. When slots open up I read another single line.