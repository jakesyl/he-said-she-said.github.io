"prev" and "next" in that function are themselves float32arrays