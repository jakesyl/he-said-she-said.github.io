the rest is manipulation of streams