I implemented runtime macros by setting global.__proto__ to be a proxy and then recorded every action done against it, worked it backwards, and generated a kind of AST from that