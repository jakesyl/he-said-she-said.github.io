guidocalvano: the usual, fixing all the bugs