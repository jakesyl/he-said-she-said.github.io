i did have it partially working when it was all one function but that stared to look a mess and seemed the wrong approach