Sly: in the code bnoordhuis posted above