async pretty much solves this kind of thing to me