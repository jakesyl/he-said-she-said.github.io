covi: i'm jumping in the middle here, but nsm means that a single 'data' event is a single packet, not the entire data stream. so you'll need to accumulate the data coming in until you receive the 'end' event which signals that all the data has been received.