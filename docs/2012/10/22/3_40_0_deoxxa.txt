gavin_huang: now handle circular requirements