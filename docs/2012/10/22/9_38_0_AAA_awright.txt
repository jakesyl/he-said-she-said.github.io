gavin_huang: Browserify does exactly what you want I think. It provides a context for each module definition (that is to say, a function definition, and the require() function to call them.)