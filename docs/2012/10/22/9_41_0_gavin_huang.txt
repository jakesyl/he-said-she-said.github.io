I seen the only major difference in this case between common js and browser is that in browser, global variables in a file is automatically populate to the global scope. but if you write code carefully, and only expose one global variable, it can simulate the commonjs env. that's why I would like a preprocess to "perfectly" convert the code between these two envs 