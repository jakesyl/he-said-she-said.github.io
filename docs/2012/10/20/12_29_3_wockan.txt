client.connect('data', function...) does it take 1 flush at a time?