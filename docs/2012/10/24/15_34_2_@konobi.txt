dschatz: why not use a library that handles that for you