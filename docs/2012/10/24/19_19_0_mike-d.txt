WarheadsSE: large switch, depends on the amount of work done in each pass, sounds like this might be a state machine / VM? 