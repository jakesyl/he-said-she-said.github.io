jpw, you need to do it all through callbacks