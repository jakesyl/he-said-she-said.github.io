ugh, i'm gonna look at this code in a year and hate myself