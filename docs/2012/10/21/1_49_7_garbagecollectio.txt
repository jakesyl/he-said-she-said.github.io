how does it know when it ends?