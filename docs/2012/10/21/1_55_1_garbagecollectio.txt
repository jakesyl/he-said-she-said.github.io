then how does it eventually get to the .end callback