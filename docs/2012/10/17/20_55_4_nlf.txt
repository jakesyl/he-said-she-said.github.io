it's ugly, but it worked