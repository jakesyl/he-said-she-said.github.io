the latter is much easier and robust