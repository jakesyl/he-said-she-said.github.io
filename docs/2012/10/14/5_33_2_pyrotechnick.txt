chapel: rewriting what i had back to JS :D