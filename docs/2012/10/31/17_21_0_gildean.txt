EuroNerd: it's a bit of a mess, how about first cleaning up some parts, like removing duplicate requires etc.