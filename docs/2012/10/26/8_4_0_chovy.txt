into separate functions wrapped by a closure to pass data down the chain