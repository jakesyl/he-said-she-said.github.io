but i found that the implementation was really hard to follow