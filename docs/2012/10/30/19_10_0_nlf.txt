making sockets behave more synchronously feels dirty