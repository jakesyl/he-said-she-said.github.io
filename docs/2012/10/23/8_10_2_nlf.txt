i might be re-implementing some of this tomorrow (technically today)