your is_authenticated wrapper can perfectly be converted to middleware.