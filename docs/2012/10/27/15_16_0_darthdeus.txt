i've tried abstracting some things, but i find that most of the code relies on the `socket` object