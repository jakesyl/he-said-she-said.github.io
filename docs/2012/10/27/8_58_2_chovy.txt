it seems to me, emails should be queued and let some other process handle sending them.