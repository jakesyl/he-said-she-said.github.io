darthdeus: make small single-purpose modules and write tests for them.