Before adding this logic, the single process used about 70% of the core it was assigned to.