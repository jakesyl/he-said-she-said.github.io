deviantgeek, I'd show you the code, but it's in a dev branch I don't have committed yet