friend of mine just re-wrote it from my first hacked version to something much prettier