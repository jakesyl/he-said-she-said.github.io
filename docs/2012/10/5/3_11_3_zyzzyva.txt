now unless scala accepts a table as a function, you have to convert it