looping through a buffer though