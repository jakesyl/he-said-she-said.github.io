xp_prg: No matter what, you don't need to "push all its state onto a stack", you realise that every function call in ECMAScript keeps its own variable scope? Just don't use global variables and you'll have no stack to worry about