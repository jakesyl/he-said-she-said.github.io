xp_prg: just use callbacks