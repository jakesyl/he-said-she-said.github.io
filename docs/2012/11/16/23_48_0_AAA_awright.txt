Two thirds of that code is utilizing readline