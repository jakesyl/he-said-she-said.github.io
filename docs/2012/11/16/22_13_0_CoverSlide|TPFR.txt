xp_prg: you have to exit the loop to receive any events