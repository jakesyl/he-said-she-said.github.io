I need to take something that's not blocking, and somehow I need to wait for it to finish, because I'm shoe-horning APIs together.  I know that this is stupid, if that's the best you can help, it's not that helpful. I'm trying to make connect-cookie-session use a new cookieEncoder that will read gzipped cookies, but gzip is non-blocking and cookieEncoder.decode doesn't do callbacks