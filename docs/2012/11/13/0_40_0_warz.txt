what you described sounds pretty simple. just push and pop using a list, in redis.