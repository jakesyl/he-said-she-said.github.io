Okay, probably put more effort into that gist... https://gist.github.com/4170876