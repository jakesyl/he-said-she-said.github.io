Also, your callback invoke needs to go in to the on 'end' listener.