It's funny how trying to get resilient about such things always seems to end up with the temptation to write your own message queue server from scratch. 