it's not that hard, dtruss creates a d script and scripts have access to the syscall args