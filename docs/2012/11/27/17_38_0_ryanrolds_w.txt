You may want to look at using something like async.queue to pop the inserts in to the queue and once the queue is done then invoke the callback.