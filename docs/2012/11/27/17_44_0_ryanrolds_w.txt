flexd, How you get the total num lines in the csv isn't very portable, but that can always be fixed latter with very little change to what you have.