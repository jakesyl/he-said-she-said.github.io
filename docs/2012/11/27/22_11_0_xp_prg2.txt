I have lost the battle and must refactor my code to be event driven and non-blocking