jasper^off: what you want to do is make that function(database, socket, data, cb), then call cb with the result of the login (like cb(Error("invalid password")) or cb(null, user))