looking through your code, trying to wrap my head around it