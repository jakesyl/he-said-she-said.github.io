it has 2 changes from your original paste: (1) move line 18 within the closure, (2) rename the variable so that you refer to the correct 'res' object