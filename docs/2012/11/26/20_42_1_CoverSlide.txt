Kakera: it does some assertion checking as well