the biggest hurdle is in figuring out the correct recalculation order