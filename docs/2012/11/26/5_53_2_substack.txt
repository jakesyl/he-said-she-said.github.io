ljharb: use through(fn) for the middle part https://github.com/dominictarr/through