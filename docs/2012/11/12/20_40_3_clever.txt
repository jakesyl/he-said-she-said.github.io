internaly, it cant make full use and must flush after each file