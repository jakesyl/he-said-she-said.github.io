JHoglund: no problem.  Essentially, all that one function does is a fancy wrapped-up version of what Hotroot was suggesting.