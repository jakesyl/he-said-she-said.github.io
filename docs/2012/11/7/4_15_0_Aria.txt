Commits + signatures + hashes of everything = almost exactly what you want.