it seems a waste to decompress it to disk first. but that part looks easy..