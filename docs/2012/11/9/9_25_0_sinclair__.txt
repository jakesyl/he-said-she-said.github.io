(a copy and paste from the tsc code)