peterrs: i know wsduplicatesocket requires some back and forth on both sides