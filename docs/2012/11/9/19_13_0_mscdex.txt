warz: use a thread for the part that does i/o ?