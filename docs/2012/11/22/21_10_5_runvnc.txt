maybe you would want to look at the code for the existing view engines and copy that patterns in them