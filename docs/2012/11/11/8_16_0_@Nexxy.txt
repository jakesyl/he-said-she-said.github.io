graeme_f, you could use something like async's queue