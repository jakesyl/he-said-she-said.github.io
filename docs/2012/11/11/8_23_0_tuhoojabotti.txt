graeme_f: Maybe you should make QR a writable stream, then return false in the write function when you need to slow down.