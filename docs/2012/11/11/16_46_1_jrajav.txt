Guess the encoding with libmagic, convert with buffer if it's utf8 or utf16le, if it's any other Unicode run iconv to convert to utf8, if it's a non-unicode encoding just try to read as utf8