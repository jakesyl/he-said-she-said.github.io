in those cases, I'd use a library like async to make it easier to use