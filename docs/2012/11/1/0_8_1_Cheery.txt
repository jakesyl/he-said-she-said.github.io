We probably need to rename some things, and fix couple bugs I may have introduced.