timoxley: https://github.com/Raynos/composite/blob/master/index.js#L12 I tried to implement the async version as a reduce but it was buggy so I used a state machine