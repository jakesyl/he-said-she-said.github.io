Tixz: Those are always hard to do, use a btree (a database) or implement some number of bins, each of which takes a different priority range for items