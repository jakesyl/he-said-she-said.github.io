old code still uses async reduce