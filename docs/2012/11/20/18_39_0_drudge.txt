i have middleware after the token route, where i send either a 200 status and the user json or an error