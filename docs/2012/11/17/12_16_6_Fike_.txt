basically I have a function that connects to a server, but I need it to emit events