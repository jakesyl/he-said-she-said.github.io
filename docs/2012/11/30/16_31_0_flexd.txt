Uh, am I doing this in a completely stupid way? Besides not using an ORM https://gist.github.com/6966bfce769dc2ed2ff5