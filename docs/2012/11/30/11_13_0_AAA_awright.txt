But the code is like twice as complex as it needs to be >_<