Damn, this code would look nicer without eight consecutive case statements each falling through to the next :(