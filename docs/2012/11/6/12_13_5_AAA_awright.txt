syskk: It's non-trivial logic, about 440 lines split across 5 files