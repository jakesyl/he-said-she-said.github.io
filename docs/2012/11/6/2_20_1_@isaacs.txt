dscape: so, what's the actual problem?  can you reduce it to a test case that's ~20 lines long, instead of a 200 line module?