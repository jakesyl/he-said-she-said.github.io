updated the gist with the done function