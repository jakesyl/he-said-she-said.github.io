http://pastebin.com/3SCntvAM   <--  I know the problem has to do with the asynchronous execution? but how can I get the results of $products outside the inner function once the execution is complete??? 