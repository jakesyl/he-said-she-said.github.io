bartek: i'm using promise pattern for this.. still doesnt look like synchronous code, but nicer than the hell