it shouldn't need to be that complicated. on my git server i have a post-receive hook, and all it has in it is `GIT_WORK_TREE=/path/to/dir/ git checkout -f`