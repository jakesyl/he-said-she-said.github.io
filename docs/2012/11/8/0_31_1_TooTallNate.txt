tnorris: well speed isn't much of a concern, it's just one stream, but it'll clean up the code at least