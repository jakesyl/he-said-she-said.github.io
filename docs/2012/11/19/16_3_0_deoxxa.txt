in reality though, this is all pretty well defined - it's totally doable to parse this quite quickly in node