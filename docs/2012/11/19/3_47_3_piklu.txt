your code must be blocking