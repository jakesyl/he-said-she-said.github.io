My problem is that after calling next() my program is executing wrong function