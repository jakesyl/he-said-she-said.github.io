here's my iterate function, I find it useful https://github.com/Benvie/continuum/blob/gh-pages/engine/utility.js#L360