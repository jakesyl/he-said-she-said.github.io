mmalecki: writing streams is already a pain in the ass