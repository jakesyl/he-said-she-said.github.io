what is a good way to refactor my code to not use events for calling async things