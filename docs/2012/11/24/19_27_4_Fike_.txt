doesn't use regex though, so rewriting the core