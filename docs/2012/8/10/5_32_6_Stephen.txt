You should add all your filenames into an array then have a broker method add them into the async queue in limited batches