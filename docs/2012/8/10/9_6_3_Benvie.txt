https://gist.github.com/2879370 might illustrate how I do things