and for priorities, queue data from each stream and process it round-robin in N-byte chunks. each stream receives stream.priority tokens.