it just takes some clever abuse of metaprogramming