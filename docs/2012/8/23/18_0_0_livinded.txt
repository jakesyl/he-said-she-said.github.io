not trivial, but it'll work on unix and windows