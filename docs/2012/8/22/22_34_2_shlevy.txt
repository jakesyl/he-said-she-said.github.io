Couldn't you keep the original errno around and fallback to strerror in the unknown case?