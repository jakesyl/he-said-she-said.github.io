but it crashes near the end and ONLY near the end