It turns out that it is possible to replace the socket used by http.request with your own.