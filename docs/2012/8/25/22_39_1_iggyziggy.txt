that's gonna be some ugly code...