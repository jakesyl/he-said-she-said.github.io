hard to compile, but doable