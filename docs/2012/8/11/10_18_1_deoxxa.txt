i've just refactored the parser and producer so they can more easily handle arbitrary message types