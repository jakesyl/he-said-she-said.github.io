this article is for pre-aggrigation framework though