mtsr: I guess that's right, but when calculating len it should check if it's smaller