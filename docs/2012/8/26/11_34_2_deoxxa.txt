the complex part is in the application logic, keeping track of things like which peers have you choked etc