i have a mostly-working implementation of that