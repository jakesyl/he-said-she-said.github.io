RLa, java code: http://dpaste.com/787478/