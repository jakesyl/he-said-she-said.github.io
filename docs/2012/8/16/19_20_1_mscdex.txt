styol: it's one option, if it's something that is really blocking for that long. if you really want to keep it in-process, process the data in well-defined chunks instead of a bunch of deferred actions