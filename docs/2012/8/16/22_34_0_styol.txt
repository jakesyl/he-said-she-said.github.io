tprice: interesting, presently am using something along these lines http://pastie.org/4523094