hmm. well, after about an hour and a half, i've managed to monkeypatch something together that actually runs.  it probably won't work in the slightest, but it runs!