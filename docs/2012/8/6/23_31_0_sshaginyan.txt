WarheadsSE: http://pastie.org/4402587