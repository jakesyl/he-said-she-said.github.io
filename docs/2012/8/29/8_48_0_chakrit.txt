erione: can you not just write everything at once as soon as the process start and just wait for it to be consumed?