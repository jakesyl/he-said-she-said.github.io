it works ok for n < 3000