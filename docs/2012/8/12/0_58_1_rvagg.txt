end() makes it annoying, brings in more state cause of async