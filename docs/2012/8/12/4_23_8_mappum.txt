i have a huge ugly piel of code that evolved a bunch of times