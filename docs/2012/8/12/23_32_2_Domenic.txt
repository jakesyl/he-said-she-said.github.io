I don't see how that violates the separation. There is only a single promise (the returned one) that passes out of both examples. The rest are intermediaries (thing temporary variables in sync code)