http://pastebin.com/4qq3cxsJ