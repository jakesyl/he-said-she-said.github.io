https://gist.github.com/3285155 here is the code, the error node throws is in the comments