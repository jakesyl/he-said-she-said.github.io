it has to be preallocated