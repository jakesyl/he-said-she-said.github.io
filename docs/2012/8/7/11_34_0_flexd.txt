I need to stop it from throwing exceptions and rather return error codes though