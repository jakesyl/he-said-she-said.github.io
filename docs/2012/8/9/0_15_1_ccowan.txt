similar to how Rails does it