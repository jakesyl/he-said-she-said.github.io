the old behavior would sometimes hang