oh req.end() is getting called at a random point