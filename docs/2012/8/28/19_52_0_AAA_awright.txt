I also look around at other libraries. Look at how Facebook, etc, sends message authentication codes, look at how MediaWiki, Drupal and such formats and stores hashes