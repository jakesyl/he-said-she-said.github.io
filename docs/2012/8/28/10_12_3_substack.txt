or you could have your modules that need your state register callbacks and then call THEM with the state