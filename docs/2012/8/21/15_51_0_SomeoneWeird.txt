http://pastebin.com/PHhQ3Js8