geroninoob: you would need your function to accept a callback as well