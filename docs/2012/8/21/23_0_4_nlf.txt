with a fancy messaging layer