"end" will emit before "close" and will end the res, making another call to end() a no-op