I've been playing with split and substring, but its not completely right yet :)