what is the best way to write that. I want the http request to be inside a function