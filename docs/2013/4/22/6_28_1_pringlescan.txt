I know it sounds stupid, but when you queue database inserts, I don't know how you're supposed to know all of them have finished. You're using the callbacks to control the queue, not your code. I end up waiting until the queue is drained, or I get an 'end' event, and I do a setTimeOut and make sure the .count() from MongoDB matches the number of inserts that didn't throw an err