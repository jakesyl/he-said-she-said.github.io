there are already some exampe ive seen on passport.js github for exactly what you need