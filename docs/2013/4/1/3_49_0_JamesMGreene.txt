In the latter scenario I could potentially use piping, though I'm curious: in which stream would you add data filtering? reader or writer?