both cases should result in the stream closing itself and sorting itself out