once end is called error should not be called