trippeh: state machine, e.g. https://github.com/yui/yeti/blob/v0.2.20/lib/blizzard/session.js#L693-L837