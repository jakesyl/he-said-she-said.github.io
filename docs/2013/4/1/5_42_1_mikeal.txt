streams are guaranteed to emit *either* error or end