I'll do more cleaning up on it, but for now, it works