see https://github.com/einaros/ws/blob/master/src/validation.cc