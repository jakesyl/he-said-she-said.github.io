http://hastebin.com/xebegovuga.cpp