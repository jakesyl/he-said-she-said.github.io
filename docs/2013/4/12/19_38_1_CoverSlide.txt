maybe gist some of the code