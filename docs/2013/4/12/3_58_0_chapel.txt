you're codes a mess to my eyes (I don't like doing super nested functions called in many different areas