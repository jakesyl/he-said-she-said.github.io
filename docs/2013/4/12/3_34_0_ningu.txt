hrm... async.each seems to be calling its final callback more than once :(