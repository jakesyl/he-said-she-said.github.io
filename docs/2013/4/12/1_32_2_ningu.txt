I've been using an SQL generator, which solves much of the issue. hand-writing SQL is kind of crazy for most cases.