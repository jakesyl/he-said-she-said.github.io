it seems to be async calling the end callback more than once which is really weird