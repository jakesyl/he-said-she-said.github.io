listochkin: for starters, you can always check process.domain or require('domain').active to see if a function is executing inside a domain