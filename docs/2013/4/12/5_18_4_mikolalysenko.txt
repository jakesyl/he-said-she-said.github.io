in fact the whole thing is defined in a giant with() block