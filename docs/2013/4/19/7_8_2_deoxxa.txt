basically streams are not fun when the whole thing is synchronous