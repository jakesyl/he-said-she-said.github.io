nikkubhai: the reason that happens is because the generate() function returns immediately, and the callback is executed some time in the future, so the modtext is still undefined