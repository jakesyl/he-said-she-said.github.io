Hmm. Ok, that's ~1d spent poking around ways of making this go fast. Time to write it as fast as I can right now. I can make it go faster again after I ship a beta.