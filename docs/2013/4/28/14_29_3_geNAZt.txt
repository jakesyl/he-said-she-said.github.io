close gets called if the socket closes (either on end or on error)