mrvisser: took some work to deal with the memory leakage!