davve_, about the process.nextTick problem, I think the rightmost part of the error message is what you're looking for: "Please use setImmediate for recursive deferral."