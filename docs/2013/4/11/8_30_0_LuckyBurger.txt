yeah that looks like it could have performance issues. id spawn a child proc for each socket...that way theres a thread per socket. but i havent reallllllllly looked at the cluster stuff yet.