this might help (it's mine) http://stackoverflow.com/questions/15936462/how-to-reliably-maintain-an-array-of-connected-sockets-in-nodejs/15937829