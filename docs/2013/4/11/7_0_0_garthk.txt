Came out at ~400 LOC, ~50% tests. :)