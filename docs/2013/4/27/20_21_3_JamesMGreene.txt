Really don't plan on rewriting this yet again, though, so oh well