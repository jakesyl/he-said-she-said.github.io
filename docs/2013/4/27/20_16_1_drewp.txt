why a tempfile? just stream it to the final place or don't process it at all