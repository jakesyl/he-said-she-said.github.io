niggler: this is a LZW implementation and it is flawed. I have just tested it