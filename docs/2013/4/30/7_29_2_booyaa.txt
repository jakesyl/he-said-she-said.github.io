yes i know it's hideous bit of code :D