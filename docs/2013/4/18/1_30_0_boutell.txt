also, I assume I need to call out.end() on a write error if I'm giving up on the stream. But will that trigger an 'end' event? If so I need to set a flag to track that I did this in response to an error so I don't call my completion callback in my 'end' handler.