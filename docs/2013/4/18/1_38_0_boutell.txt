does a stream error also trigger end and/or clean up the stream in whatever way is necessary?