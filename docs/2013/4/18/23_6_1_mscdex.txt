aleksandar: this is unrelated, but you can rewrite your retVal function to be a lot smaller :-)