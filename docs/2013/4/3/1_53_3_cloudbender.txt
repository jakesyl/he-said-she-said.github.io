I wrote a 'task scheduler' for a similar problem.