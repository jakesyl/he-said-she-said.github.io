emit-stream and dnode seem to be different sides of the same coin in a way