i don't know that this will help you, it was written for a tent.io app https://github.com/jeena/Bungloo/blob/master/WebKit/scripts/controller/Oauth.js