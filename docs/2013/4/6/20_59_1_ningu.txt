the fact that you have to rewrite createConnection that way tells me that it isn't meant to be done like that