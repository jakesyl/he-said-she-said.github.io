brutalhonesty: (1) don't close the connection until the end, (2) return train_samples isn't going to work, you need to pass a callback and call it