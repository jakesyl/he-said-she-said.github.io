oh boy, once again a dive in the code :(