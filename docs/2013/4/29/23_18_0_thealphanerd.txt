you might want to take a look at other socket code