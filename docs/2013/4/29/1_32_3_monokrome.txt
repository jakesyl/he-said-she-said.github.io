I know this is probably wrong in a dozen places