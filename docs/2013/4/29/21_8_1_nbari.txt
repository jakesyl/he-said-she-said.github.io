how could I avoid the globals ?