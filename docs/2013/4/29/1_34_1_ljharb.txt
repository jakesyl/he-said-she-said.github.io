what you're trying to do is really complex, because you've got an unknown number of tasks