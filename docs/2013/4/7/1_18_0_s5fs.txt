zemonk: without seeing anything, I'd just start carving up the code until I find whatever the offending line is. i have to assume there is something different in your program execution when you're running it as a test.