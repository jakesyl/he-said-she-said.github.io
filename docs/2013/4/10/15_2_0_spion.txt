i finally figured out how to make a great oauth middleware.