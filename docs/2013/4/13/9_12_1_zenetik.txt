https://github.com/wearefractal/pinger/blob/master/src/pinger.cc