some code stolen from node-rate-limiter