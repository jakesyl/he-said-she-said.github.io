brianc: http rewrite from what I understand