there are too many moving parts for me to debug this without actually knowing the code