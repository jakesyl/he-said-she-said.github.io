hello, how bad is this design? http://hastebin.com/yimamagixo.scala