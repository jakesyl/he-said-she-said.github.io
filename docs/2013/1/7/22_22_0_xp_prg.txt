I need to convert my app to be non-blocking which uses a bunch of for loops