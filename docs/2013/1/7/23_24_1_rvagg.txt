isaacs: yeah, and that'd probably be the main benefit of pulling it out into a separate module IMO, keep the complicated logic separate