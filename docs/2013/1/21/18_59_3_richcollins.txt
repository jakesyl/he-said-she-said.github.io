How do I know when the write side of a pipe is finished?