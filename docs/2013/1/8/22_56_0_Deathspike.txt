paul__: And with ranges http://pastebin.com/kTAm5hnh