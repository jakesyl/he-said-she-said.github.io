Stephen: this is the ruby version - http://pastebin.ca/2307415