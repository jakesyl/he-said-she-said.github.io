In order to be able to run my test files alone or part of a test suite I check whether the code is running directly with the node executable.  if that's the case i run my server before running the test. if the file was required by the test suite runner, i just export the test so the runner will call it.  Here are 2 version of one of the test files - http://hastebin.com/koviwopome.js  they are doing the 