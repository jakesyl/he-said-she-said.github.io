you could always use two hmac algorithms, time based one for the first part, event based for the second part