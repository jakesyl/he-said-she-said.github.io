async.queue would probably be handy in this case