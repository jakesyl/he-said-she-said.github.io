create a middleware that is first in stack