if you write your data access layer as a plugin, you can use github.com/c9/architect or github.com/flatiron/broadway to handle all the setup / teardown logic for you