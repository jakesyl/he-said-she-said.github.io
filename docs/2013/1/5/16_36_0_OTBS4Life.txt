Yes, I did that.  That works fine.  Unfortunately, it gets a little hairy when I have several middlewares that need to do this.  They have to save references to the old end function and then call it.