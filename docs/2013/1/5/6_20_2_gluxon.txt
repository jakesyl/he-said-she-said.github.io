lietu: I feel like you issue may be related to non-blocking IO.