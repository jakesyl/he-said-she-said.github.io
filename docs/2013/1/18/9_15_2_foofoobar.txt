But I'm confused with this single-thread approach