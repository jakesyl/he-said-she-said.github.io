magic can also be side-effect free, composable and scale trivially on many core