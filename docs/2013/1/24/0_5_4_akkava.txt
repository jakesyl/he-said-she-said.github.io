sorry, it was a typo on my side, instead of checking for protocol == 'https:' I was comparing with 'https://'