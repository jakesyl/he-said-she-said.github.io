i'd use eval if 'path' is known, then you can get rid of these 3 loops