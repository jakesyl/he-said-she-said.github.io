any functional language compiler is basically magic