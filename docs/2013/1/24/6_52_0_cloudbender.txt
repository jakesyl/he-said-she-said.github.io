5 messages per second. You said HUGE ARRAYS.  Is iteration killing you ?