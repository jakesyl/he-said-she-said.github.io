you might want to read the source of libuv