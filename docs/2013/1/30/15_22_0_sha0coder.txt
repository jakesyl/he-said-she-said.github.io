i need to wait for a function end