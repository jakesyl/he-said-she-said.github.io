AviMarcus: ok, so the error handling could be better (I haven't decided how to do that yet) but you're missing key fields required for an NAPTR record