andrew12: sadly, I can't use promises here