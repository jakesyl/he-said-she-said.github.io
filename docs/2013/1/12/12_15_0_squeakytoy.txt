unless d is a total mess and rewriting can optimize everything