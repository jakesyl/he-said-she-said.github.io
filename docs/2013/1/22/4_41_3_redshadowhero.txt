Yeah, parsing this based on tokens shouldn't be too hard.