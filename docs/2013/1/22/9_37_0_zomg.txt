Wouldn't it be simpler to just put the most recent valid access to a database and then just check against that, and return an erroneous response if the user exceeds the limit