i have foun some code, which i think i can use as a start point and port it http://code.google.com/p/ruby-imapd/source/browse/trunk/imapd.rb