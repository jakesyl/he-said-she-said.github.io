(Proof of concept, mind you. < 40 lines)