this is a function that can only be done correctly by the template parser itself