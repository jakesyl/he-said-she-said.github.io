and more consistent error handling