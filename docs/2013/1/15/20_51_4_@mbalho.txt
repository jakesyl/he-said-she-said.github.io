dgs: do it in memory