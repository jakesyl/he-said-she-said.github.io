trying to figure out where the bug is, but thought ffi might be another approach