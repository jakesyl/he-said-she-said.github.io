it's kind of fun to design tight algorithms in C