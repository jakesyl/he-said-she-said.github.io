I'll have to refactor a little, but ultimately not too bad.