oh man, you have no idea how bad this legacy code is