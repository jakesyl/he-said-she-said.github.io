im not sure how to perform an upsert for a nested object. I have a checkins document and i want to update orders of different items, if the item exist, just add an order, if it doesnt, add the item and nest the ordet. this is what i got so far, but i dont see it going to work. https://gist.github.com/4655708