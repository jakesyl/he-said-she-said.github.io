i'm ashamed i wrote this http://pastie.org/private/kkc4ghadc7tvoocz3ej7zg