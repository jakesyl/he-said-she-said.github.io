I ended up abandoning the project when I couldn't make it through DOM hell