jvanveen: In case you happen to have a second to look at the code: http://pastebin.com/svPjedak