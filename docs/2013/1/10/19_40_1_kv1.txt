my funciton is returning without processing the result