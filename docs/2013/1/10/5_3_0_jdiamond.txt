cr11sh_: in other words, move your call to query to right after line 11 (inside the connect callback) so that you don't try to execute the query before the connection succeeds.