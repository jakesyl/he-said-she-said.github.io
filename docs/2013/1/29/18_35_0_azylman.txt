Sounds like something you should be letting the database handle