min|dvir|us: and then partially rewritten at least twice since then :P