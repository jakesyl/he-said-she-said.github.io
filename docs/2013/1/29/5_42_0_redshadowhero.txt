I feel really stupid about the second one, because I had recoded all of google's java files into C, only to find out the pam modules had everything I was writing anyway.