actually, iirc there's an efficient algo for dealing with memory pools, the name escapes me right now though