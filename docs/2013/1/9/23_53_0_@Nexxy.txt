DIY type checking and constraints