however, that whole function seems to be so strange that JSLint fails to even try and understand it