anyone know why this code doesn't work when 1 client is connected, but works fine when >1 are connected? https://gist.github.com/zivester/5233347