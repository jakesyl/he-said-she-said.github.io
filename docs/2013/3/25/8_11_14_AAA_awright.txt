It also breaks the object model... It could be the case that getConnection() is not an instanceof require('database').Connection