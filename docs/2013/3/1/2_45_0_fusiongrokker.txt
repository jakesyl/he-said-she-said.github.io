I need to port this so that it can work in a web app without dumping out to the shell