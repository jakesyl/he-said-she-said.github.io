ChrisPaterson, http://pastebin.com/dYmjpYHu