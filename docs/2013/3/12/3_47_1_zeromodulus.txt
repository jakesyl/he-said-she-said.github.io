eh, seems pretty simple, but, do any problems catch your eye with thise code? https://gist.github.com/zeromodulus/5140143