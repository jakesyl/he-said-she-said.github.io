my database connection is being closed prematurely?