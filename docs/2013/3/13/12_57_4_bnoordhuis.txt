you could batch the diffs and when they exceed some threshold, you hand them off to the main thread