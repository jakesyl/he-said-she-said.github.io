redis_callback_inspired_by_code_coderarity_stole_from_me