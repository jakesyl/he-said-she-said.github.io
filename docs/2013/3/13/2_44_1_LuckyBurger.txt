Normally I would spawn threads and wait for them to finish