Anup: if you are brave enough just read the async module's code