baranaby: you'd probably want to mock the database stuff