also, you probably want to use async.reduce in your example