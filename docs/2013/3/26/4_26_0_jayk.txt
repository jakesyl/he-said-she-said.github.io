perhaps it makes sense to make a protocol handler class thing that sets up the sizes for each bit in advance and fills itself out as data is received.