It looks like a matrix calculation.