genazt: http://www.hastebin.com/mipefareba.rb