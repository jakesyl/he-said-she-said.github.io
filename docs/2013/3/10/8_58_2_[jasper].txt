http://www.hastebin.com/lewiheyoge.rb