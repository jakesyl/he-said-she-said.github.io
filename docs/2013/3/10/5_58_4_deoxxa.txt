and doing all processing in code