yeah, this should be in pipe()