In node.js, how would you handle a mapreduce problem where each map step requires some asynchronous call? How do you stall the reduce step until everything is ready?