s3shs: well you need to have a message queue, and the queue is the authority for rollback