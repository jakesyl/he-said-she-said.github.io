Your code is quite messy, hard for me to follow