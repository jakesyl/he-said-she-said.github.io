I guess the part I'm uncomfortable with is passing around the connection until the commit.