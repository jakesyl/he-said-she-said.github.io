How am I supposed to exit the program when the incoming stream ends?