is there some additional constraint preventing you just looping over the input string?