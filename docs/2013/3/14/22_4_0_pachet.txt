rest is done via message passing