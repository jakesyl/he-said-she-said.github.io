(1) Don't write your own crypto. Use functions explicitly approved for your use: HMAC, PBKDF2