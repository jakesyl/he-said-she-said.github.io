mt: to your original question, the problem usually boils down to managing the possibility of your processes crashing while holding a message (todo, in your case)