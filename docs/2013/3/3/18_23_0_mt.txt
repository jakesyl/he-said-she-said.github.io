I think I just understood what TJ is doing in the batch function.