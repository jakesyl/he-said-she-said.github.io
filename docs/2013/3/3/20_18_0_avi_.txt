KPS: that entire project might have some code relevant to your problem 