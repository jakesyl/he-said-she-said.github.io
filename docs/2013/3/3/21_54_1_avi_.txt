steffkes: or use a lexer/parser generator if you're comfortable with that