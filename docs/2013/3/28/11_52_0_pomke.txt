What I see most (all?) connect based api servers in node doing is something like: define every API anyone could need, then in each, check the current user/session has permission to do this thing, then do it