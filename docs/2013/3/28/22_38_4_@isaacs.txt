ljharb: there are bigger refactors that need to happen first.