Any domain experts? What's wrong with this code: https://gist.github.com/hueniverse/5114176 ?