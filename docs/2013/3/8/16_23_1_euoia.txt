the main problem you had was with the async nature of the operations, these approaches address that