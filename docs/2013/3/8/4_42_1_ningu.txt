see caolan's async, that might help