I must be missing something because when I do a request inside socket.on the success never fires