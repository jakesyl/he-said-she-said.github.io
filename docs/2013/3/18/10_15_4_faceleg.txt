ningu: http://hastebin.com/sikomamixe.cpp