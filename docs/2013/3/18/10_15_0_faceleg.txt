ningu: http://hastebin.com/kumukivixa.cpp