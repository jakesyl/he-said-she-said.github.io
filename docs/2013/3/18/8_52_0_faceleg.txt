ningu: http://hastebin.com/yefipetope.cpp