does anyone know how to write node tests that can 1) create a client request and 2) check the state of that request before and after it passes through a middleware?