s3shs: looks overly complex