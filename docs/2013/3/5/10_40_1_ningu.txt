I have no idea how imagediff works but the source is pretty short.