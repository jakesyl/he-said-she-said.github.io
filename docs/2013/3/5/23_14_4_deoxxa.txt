niggler: i've been thinking about how to do it properly with a stream, and the only way i can think of to get it perfectly right is to do two runs through the stream