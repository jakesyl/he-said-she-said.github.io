Just curious, have you thought of using something like phantomjs?