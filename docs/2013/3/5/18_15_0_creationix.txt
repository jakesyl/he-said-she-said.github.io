warz: though to clean things up, I would probably write a generic chunk function