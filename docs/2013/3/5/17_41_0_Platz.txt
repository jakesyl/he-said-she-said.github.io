sample input: http://pastebin.com/d0792t2B