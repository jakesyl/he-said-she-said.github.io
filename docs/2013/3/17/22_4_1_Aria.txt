Industrial: You use a ranked set, use the ranks as keys, do the query in the ranked set for the index you want, then go retrieve the actual keys.