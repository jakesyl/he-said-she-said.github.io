Aria: so if I understand correctly, the new piece of code would be http://paste.kde.org/698684/