the rewritin it into nodejs would be rather time consuming