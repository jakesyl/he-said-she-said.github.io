to be fair the code is *much* cleaner than it was