I could of course strip out the unrelated stuff