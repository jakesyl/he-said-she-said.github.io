maybe the problem is the shared buffer in the example?