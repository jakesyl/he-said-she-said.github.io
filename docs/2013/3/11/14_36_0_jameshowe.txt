but it doesn't segfault unless it's called in a worker thread