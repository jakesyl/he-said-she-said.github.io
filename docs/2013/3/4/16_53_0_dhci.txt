so I would have res.end calls in the query failure section, the query end section, etc. to catch all the cases