I think I just need to listen for 'close' and check had_error