so I'll just rewrite it all into functions