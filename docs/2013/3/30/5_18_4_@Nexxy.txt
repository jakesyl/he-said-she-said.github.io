with a few extra hacks on it