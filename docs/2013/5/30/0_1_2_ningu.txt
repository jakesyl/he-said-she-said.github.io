you could reuse almost all of the code