james`: I think both solutions could be made efficient.  I think Node would about a million times more fun, and would more easily run in parallel if you didn't have dependencies from one record to the next