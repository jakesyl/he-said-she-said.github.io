Is there anything wrong in principal with this design:    https://gist.github.com/dukedave/5505590