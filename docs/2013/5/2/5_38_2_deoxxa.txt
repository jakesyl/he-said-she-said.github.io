well, iptables is really good at doing what you're talking about