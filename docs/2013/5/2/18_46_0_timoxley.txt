dwierenga code is usually clearer if you break things up into multiple phases or encapsulate the tasks in another async call