I think AMD solves my problem although I would need to implement it for Node.js