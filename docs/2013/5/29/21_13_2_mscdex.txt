didn't nginx have some custom protocol for sending the client ip for tcp proxying?