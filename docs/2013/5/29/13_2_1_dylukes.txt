What's the accepted/nice way of writing native extensions these days?