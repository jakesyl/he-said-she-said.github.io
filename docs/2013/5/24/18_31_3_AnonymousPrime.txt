firewall is a good suspect, though why that kicks in on the same batch file that runs correctly from prompt seems weird