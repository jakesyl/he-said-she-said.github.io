I think there HAS to be a continuation-style source code transform.