nathan7, I'll pastebin pseudo code.