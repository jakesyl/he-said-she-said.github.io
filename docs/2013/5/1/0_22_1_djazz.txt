it must be done in realtime