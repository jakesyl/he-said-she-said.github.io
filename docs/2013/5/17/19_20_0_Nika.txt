I have a function that takes some time to run and in the end it produces global array