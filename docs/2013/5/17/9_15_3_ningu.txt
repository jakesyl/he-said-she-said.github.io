well, I think you should look into something that takes treams and emits 'line' events