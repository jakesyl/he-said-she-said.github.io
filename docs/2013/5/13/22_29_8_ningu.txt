ljharb_work: it also hides the actual control flow somewhat