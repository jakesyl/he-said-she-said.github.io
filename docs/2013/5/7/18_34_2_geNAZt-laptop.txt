the waterfall in async should behave the same as your implementation