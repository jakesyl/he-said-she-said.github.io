In either case, writing an application body or a library/module body, the function is called once per process. Nonetheless trying to do both inside a single function body causes trouble.