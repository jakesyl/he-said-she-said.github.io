ok first ill restructure my code now, do the data crunching in routes