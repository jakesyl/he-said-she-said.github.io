I've seen code that tests for whether setImmediate exists and uses it in preference to process.nextTick, not sure if that's actally 'right'