kenperkins: you don't have to call end() yourself