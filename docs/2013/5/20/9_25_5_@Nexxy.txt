sinclair|nz, perhaps you should use domains and decouple your lib from the socket