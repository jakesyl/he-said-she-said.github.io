cjwfuller: ok. well, I'd suggest again then, that you look at bouncy. I'm not sure if it can do what you want or not, but if not you can get some ideas from the code.