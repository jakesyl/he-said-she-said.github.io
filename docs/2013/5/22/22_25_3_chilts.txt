what is 'check_auth' doing?