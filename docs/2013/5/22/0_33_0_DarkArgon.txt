there probably already are modules that can do all the stuff you want