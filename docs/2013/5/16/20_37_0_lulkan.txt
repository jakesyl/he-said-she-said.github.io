wrapped it up in a transaction and it runs in less than a second now