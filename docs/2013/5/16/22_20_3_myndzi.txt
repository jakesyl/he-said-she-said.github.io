seems like a complicated test to get right