based on that example, I believe the code is correct: http://dpaste.de/X4aww/