http://dpaste.com/1167274/ my code