if you havent read all data the end event never gets fired