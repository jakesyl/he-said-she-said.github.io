although you may want a PEG or something antlr-based