I guess my main concern is if I use the second approach (which is of course better), will it be synchronous enough that it hops to the response.end() first?