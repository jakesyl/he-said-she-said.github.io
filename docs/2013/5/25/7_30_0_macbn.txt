i use async, but my code itself is complex