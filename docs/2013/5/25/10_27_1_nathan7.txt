eddyb9: named functions are extremely useful, also for callbacks