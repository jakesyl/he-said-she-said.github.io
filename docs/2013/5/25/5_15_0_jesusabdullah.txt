macbn: you probably want to keep count of how many of these you process and then hit your callback when you've done them all, something like this