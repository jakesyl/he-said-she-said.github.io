there's a tiny bit of magic going on to resolve circular dependencies