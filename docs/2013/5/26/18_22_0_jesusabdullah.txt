there are a lot of annoying edge cases