I've been thinking about this over the evening, and I suppose I should be using events instead of procedural calls.