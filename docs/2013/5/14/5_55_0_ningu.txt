I've written ad-hoc solutions like yours before and they are not fun to maintain