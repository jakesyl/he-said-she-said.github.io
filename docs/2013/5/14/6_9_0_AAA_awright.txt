And it doesn't even stop there, I actually format this directly into an HTTP response. So I can produce error pages that are formatted using this mechanism, and they return an appropriate error code.