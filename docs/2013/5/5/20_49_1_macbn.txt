it works with foreach but why not async function