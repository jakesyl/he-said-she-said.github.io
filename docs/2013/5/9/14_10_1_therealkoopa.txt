Would it be possible to do this with streams?