I think you could come up with an architecture to make this work if you split it into a connection manager and handler