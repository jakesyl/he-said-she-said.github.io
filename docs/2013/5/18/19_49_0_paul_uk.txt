this is my chunking version:  although I'm not currently able to work out the length is greater than the buffer issue: http://pastie.org/7926914 