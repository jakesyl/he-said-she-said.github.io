Doing it without bugs is hard and there's a ton of edge cases