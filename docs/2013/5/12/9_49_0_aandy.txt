map reduce isn't really related here. sure, you can use map reduce, say mongo or something. but that's by far an overreach of what type of queries (questions) you'll be asking the database