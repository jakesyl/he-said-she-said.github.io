if you are doing it all in one process and blocking