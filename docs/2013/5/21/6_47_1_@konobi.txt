garthk: if it's quicker in C, why not do an addon?