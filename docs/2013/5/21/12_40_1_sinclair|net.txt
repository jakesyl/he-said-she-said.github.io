isaacbw: ok, i have rewritten that code a bit