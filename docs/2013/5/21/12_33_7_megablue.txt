or should i write C extension to deal with it?