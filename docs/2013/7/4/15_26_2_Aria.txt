That require is synchronous but package downloads are not means you have to pre-handle the dependencies, rather than doing it live.