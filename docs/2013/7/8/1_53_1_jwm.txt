have to have a handle to the socket inside the function