the functional version of that code has no query at all, and then i manually check to make sure I dont match a player against himself:  if (waitingForOpponent && (String(waitingForOpponent.player) !== String(player._id))) 