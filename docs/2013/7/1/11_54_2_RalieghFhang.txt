http://pastebin.com/4m5PLvVU