And then implement the whole thing in SQL ;-)