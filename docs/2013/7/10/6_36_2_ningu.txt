I'm quite proud of this code, actually: https://github.com/longnow/panlex-tools/blob/master/tabularize/util/column_heuristic.pl