I've had a lot of trouble with middleware ordering, howevr.