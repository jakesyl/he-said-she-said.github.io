it's a little harder in Node because of the streaming case