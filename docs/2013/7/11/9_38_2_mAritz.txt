serapath: just as an aside: try to boil problems down to as little code as possible when posting them like this. there's a lot of stuff in there that has nothing to do with the problem :)