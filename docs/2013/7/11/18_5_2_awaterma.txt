searpath, the Q promises framework might help you.