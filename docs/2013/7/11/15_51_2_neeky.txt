poincare101, middleware is trivial.  here is the pattern: https://gist.github.com/nikmartin/5976680