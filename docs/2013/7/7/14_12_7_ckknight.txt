and do the logging and all that