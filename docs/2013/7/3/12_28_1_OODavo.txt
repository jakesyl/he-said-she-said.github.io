Aha, turns out npm scripts do run in an odd environment, compared to the normal shell: They add executables from node_modules to the PATH, so it was running a local install of Mocha inside node_modules instead of a global one.