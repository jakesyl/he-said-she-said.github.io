pachet: also, i get compile time checking on the kernel too, and use generics to type the kernel input and output