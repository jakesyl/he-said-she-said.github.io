anyway, re: persistent data structures, take a look at mori