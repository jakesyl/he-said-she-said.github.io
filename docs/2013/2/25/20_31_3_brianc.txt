and will transparently upgrade to web sockets if they're supported