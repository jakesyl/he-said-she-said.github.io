this is my latest module source -- http://pastie.org/6330230