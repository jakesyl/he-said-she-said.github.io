look at node-fibers for a similar idea