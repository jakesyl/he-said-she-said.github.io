error and success is mixed up in your middleware