basically does what I want, except it seems buggy