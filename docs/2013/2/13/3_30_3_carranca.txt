denom: seems really complicate to refactor :P