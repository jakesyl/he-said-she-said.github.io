And the code is here: https://gist.github.com/Pinkerton/4947821