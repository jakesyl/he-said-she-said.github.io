There is - somewhere on the wiki or blog - a great discussion on how to deal with long-running, blocking, functions