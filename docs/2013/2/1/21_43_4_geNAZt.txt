https://github.com/zetaweb/aspen.js/blob/master/aspen.js#L39