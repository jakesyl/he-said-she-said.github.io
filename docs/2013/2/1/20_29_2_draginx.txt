Is there any reason why you cant take an array and group by it asynchronously?