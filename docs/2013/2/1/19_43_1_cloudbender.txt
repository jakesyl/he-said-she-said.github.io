ok ... comments welcome when you have time. https://gist.github.com/4693344