MongoDB  can do .map and .reduce, but handling that in JS if fairly straight forward