yeah it needs some sort of atomicity