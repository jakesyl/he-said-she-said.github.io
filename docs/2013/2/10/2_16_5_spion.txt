it also has some logic to avoid overzealous endless restarting