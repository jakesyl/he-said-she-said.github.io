what you want to do is instead of putting the callback in http.createServer, you use a named function declaration, and use that as the callback for both your HTTPServer and HTTPSServer