yes, you'll have to keep track of the expected number of callbacks, decrement as appropriate, deal with propagating errors back to the final, etc