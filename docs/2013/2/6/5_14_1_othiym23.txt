the instrumentation is inserted via wrapping functions up in closures