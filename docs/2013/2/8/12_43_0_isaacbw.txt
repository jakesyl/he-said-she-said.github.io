what I was doing was imap.seq.fetch(total-20 + ':*') and instead of giving me the last twenty messages, it was just giving me a single message which was the last, and it had a seqno lower than messages.total