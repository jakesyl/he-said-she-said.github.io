othiym23: the only problem is that visitor function is one that is callback and takes callback, that's the only dirty part