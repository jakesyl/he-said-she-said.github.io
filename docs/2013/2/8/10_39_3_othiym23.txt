the async version is super easy to debug -- forEachSeries is about 20 lines of code