if I were you, I'd probably step through the failing example with node-inspector and see what's happening as you go through d.run into the aws code into your callback setup