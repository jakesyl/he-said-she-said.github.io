isaacbw: here is my code http://pastie.org/6311761