mb: looks like you're racing to the end. connection.query is using a callback, so it's not called immediately.. but your response.end() is.