hes making it internally to each api end point, without a crazy chain of middleware