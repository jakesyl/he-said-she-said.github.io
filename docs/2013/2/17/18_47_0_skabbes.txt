it _works_ but its not exactly the prettiest code / api