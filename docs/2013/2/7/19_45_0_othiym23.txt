it seems like there should be a higher-level abstraction for this -- maybe I just need to write one ;)