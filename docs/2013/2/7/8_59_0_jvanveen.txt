the code is a bit horrible. i didnt account for much async handling