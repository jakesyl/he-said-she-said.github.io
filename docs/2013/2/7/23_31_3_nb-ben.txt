othiym23, could probably simplify it by finding a polymorphic solution