but it's hard to do in another process because it needs access to the main thread's memory