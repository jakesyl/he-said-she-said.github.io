I think deferred() is the right tool for the job here