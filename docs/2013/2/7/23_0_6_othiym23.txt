xinmin: I'm pretty sure that weird process.nextTick() two-step I do is unnecessary and is working around a bug in domains, which is what cxreg is referring to in his last comment