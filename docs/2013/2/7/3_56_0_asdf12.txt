isaacbw: the implementation seems a lot more complex than it needs to be to me