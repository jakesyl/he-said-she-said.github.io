i debugged socket.io, it seems it detects whether its a socket.io websocket upgrade simply by checking the reuest uri is hitting /socket.io 