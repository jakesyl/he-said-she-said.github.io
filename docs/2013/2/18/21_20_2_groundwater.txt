isaacbw: it aint pretty, but it works