it will block until it's finished