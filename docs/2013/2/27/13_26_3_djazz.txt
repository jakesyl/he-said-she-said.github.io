AAA_awright: here's the full code: https://gist.github.com/daniel-j/5044334