how can I pipe data to a socket and reconnect the pipe if socket reconnects?