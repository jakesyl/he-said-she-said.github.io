mharsch: you could SIOCGIFNETMASK on the fd of the socket, but looking I don't see that exposed in core