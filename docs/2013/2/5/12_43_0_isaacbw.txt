I'm really fighting the urge to use promises in this library