it will be much easier and high-performance if you use streams though