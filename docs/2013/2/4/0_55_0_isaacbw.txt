https://gist.github.com/3889970#youre-missing-the-point-of-promises