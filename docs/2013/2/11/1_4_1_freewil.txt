basically the same thing done here: http://blog.jasonmooberry.com/2010/10/constant-time-string-comparison/