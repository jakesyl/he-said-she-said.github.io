for one thing, buffer should be an array, not a string