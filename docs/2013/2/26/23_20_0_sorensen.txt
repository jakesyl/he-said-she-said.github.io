pretty much taken from underscore.js