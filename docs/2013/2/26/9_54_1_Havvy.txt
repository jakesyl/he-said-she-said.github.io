function new (constructor, args) { var ret = Object.create(Object.getPrototypeOf(constructor)); var ret2 = constructor.apply(ret, args); return (typeof ret2 === 'function' ? ret2 : ret); }