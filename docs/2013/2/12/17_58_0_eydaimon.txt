The following seems to be something that happens often in js: http://pastie.org/6136209  with the solution below. Is there a better way of doing this?