both random bytes and hash are base64 encoded