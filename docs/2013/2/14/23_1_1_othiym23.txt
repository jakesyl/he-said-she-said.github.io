grom358: the safest thing to do is to attach an 'end' event listener to a cursor as in the example on the docs page, but I don't think there's any reason you shouldn't be able to close the connection inside your innermost callback