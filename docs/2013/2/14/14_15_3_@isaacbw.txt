ciree, everything will have to fit in memory