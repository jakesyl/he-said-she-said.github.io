if you say var last = client.query("INSERT...") on the last one, and then put your .on('end' handler there, does it work?