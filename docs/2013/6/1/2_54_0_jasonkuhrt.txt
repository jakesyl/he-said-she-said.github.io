ningu: I'll have to rewrite this for 0.10, but that's good learning for me right now anyway