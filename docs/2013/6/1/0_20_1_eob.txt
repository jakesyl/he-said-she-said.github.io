Here is a gist sketching the problem