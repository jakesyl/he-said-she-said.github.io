trying to write a reduce manually is an unreadable mess