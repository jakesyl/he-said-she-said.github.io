how add async stuff in foo function without having to call foo(callback)