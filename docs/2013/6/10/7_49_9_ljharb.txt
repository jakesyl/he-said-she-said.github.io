ckknight: as for that gist, style variances not withstanding, my solution is basically the same number of lines, and avoids a switch