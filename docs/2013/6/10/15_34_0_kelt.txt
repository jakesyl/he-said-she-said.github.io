niggler: yeah, I can refactor the code