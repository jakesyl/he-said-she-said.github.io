https://gist.github.com/jasonkuhrt/b08903ee52ae8df1b5dc#file-cloud-js-L19