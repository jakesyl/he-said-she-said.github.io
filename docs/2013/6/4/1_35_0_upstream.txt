so recursive function but I get max call size error quickly, so I wrap the recursive call in process.nextTick, and now I get warnings and another max call size