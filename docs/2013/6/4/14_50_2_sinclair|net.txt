ckknight: even after a refactor, it generally still looks like rubbish