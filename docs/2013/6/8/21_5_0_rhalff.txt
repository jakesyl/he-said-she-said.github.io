Maisre, just look at the source code of Glype also I guess, pick what you need. Common problem stuff is for sure already available in node as a module.