is there some way not to duplicate this code?