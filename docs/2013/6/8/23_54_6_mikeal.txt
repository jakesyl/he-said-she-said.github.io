what is happening is that the socket is being closed prematurely