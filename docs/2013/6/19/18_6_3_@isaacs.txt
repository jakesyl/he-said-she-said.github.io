jas-: (i realize that a lot of the code in there does it the "wrong" way.  patches welcome)