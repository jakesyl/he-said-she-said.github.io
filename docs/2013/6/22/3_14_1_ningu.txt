rud: you might look into the waterfall method in caolan's async module