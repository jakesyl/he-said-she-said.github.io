haha, well, Its a little convoluted, and a complete mess right now.   my project is in a dozen pieces and I havnt gotten around to refactoring out what I don't need. I just know that I ran into a quality problem with imagemagick, and sips was handy enough to fix it on the fly without much fuss