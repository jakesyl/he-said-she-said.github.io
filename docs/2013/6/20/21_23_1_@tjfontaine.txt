but I've made the implementation nicer in this change