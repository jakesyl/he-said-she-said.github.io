again, just use a well-tested, widely-used, pre-existing authentication module. there's lots of there in every language. don't waste time trying to write one yourself.