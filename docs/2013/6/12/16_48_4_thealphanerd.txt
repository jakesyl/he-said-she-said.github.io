the code is nasty and hacked together