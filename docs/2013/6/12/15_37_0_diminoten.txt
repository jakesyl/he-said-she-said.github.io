okay so the .end() triggers the send but why do that BEFORE defining your on error behavior