god damn, sqlite does not like long transactions