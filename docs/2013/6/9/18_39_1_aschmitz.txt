ericelliott: Just skimmed dilvie/credential, so take this with a grain of salt, but it looks like you're not using a constant-time comparison, which would be a good idea.