AAA_awright: I don't like the coupling to the output file as much though