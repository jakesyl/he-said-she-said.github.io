aschmitz: I'm skeptical that a key-stretched hash would be vulnerable to a constant-time attack, but I don't understand the attack well enough to be sure.