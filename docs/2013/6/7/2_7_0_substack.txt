I should factor out the parsing algorithm into its own lib