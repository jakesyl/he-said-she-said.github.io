and also, my point earlier was that if you have an ajax login, you could bypass a lot of the complication here by doing a workaround and just sending a token via ajax and then connecting socket by sending over that token via socket, but this might not be protected via ssl