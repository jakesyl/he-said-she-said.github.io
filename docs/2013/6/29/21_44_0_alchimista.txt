whats the problem with this code, https://gist.github.com/anonymous/c5cf17827de215adbf60