instead of having this guts-out in the server