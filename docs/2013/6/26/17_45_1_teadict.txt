add sockets and you've got real time session check