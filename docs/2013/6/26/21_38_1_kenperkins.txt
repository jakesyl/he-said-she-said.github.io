i should extract and refactor our work-queue code to wrap kue