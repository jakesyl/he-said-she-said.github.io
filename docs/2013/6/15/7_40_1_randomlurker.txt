I have db.close() in the db.collection('that', function(err, collection) {...  block. Shouldn't it work?