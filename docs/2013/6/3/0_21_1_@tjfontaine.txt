there is a significantly cleaner internal implementation on the master branch