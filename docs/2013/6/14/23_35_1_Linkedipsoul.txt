http://pastie.org/pastes/8044350/text