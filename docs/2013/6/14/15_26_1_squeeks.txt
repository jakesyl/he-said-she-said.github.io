go read up on socket.io and how it does this, after a bit of reading you'll find this is a solved problem with a not-completely-bonkers solution.