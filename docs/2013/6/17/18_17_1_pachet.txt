and spits back a custom middleware function