not sure the best way to ensure when the message is read off the queue, that it's stored successfully