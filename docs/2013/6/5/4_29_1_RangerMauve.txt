I've just been looking at the source code at the moment