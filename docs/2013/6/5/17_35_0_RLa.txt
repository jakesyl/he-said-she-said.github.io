yeah, restructured some code, now better