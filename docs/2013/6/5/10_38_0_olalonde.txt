wow you have a lot of code duplication there :p it would probably be possible to refactor at least 30 lines if you made that function more generic