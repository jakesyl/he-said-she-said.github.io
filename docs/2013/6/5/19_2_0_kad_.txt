banzounet, the trick here is to create a function dynamically and pass the external data to it's internal context so it remain available to all internal code