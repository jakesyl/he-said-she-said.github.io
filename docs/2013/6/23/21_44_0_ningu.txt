gaf: so, (1) set the right http auth headers on urls that require auth, (2) use the authorization plugin to parse out the client's auth headers, (3) use your own code to verify the password and accept it or not