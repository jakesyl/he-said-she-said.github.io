capturing exceptions and cleaning up resources