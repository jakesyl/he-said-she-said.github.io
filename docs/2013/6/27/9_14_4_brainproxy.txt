I also recommend studying kriskowal's Q library