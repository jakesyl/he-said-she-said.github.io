The trickiest bit is efficient buffer management.