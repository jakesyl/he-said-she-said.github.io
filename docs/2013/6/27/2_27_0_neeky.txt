the session check happens before any potentialy insecure routing into your app internals