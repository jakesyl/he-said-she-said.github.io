I guess I just need to maintain a reference to the last known message and resend that manually before the new pipe?