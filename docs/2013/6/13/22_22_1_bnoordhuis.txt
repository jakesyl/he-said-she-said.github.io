it's not pretty or efficient but it works