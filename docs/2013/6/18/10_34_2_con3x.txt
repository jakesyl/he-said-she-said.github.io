See the comment on line 40