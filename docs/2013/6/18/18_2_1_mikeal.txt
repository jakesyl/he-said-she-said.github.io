needs to be scrapped and re-written for new streams