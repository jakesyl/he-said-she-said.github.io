pretty sure I only call pipe once