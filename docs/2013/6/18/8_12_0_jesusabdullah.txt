nathan7: an optimist refactor would make it significantly smaller