especially handling range headers correctly