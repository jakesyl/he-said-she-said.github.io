I may have to implement the run length encoding optimizations in order to get this running as fast I'd like