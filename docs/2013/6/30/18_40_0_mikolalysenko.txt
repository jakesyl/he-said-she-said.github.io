they aren't tricky to get right.  just use knuth's algorithm