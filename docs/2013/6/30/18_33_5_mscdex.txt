ningu: like finish the queue up before closing