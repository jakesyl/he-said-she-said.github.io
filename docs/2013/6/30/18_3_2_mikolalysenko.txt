isaacbw: it is complicated, not easy to paste right now