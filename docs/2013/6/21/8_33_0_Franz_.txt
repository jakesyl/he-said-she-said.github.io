i will put the most important part of the code